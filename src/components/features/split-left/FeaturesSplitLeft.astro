---
import './FeaturesSplitLeft.css';
import { type Locale, loadT } from '../../../i18n';

interface Props {
  lang: Locale;
}

const { lang } = Astro.props;
const t = await loadT(lang, ['features']);

// Fallback translations para features si el sistema no funciona
const featuresFallback = {
  es: {
    sucesiones: {
      title: "Nuestra forma de entender el derecho",
      description: "Creemos que el derecho no es solo normativa, sino también confianza, equilibrio y humanidad.\nAcompañamos a empresas y familias en decisiones importantes, ofreciendo seguridad jurídica y calma en momentos clave."
    }
  },
  en: {
    sucesiones: {
      title: "Our way of understanding law",
      description: "We believe that law is not just regulation, but also trust, balance and humanity.\nWe accompany companies and families in important decisions, offering legal security and calm in key moments."
    }
  },
  ca: {
    sucesiones: {
      title: "La nostra forma d'entendre el dret",
      description: "Creiem que el dret no és només normativa, sinó també confiança, equilibri i humanitat.\nAcompanyem a empreses i famílies en decisions importants, oferint seguretat jurídica i calma en moments clau."
    }
  }
};

// Función helper para obtener traducciones de features con fallback
function getFeaturesTranslation(key: string) {
  const translation = t(`features.${key}`);
  if (translation === `features.${key}`) {
    // Si no se encuentra la traducción, usar fallback
    const keys = key.split('.');
    let value = featuresFallback[lang];
    for (const k of keys) {
      value = value?.[k];
    }
    return value || key;
  }
  return translation;
}

const title = getFeaturesTranslation('sucesiones.title');
const description = getFeaturesTranslation('sucesiones.description');
---

<section class="features-split-reverse-section">
  <div class="container">
    <div class="features-split-reverse-grid">
      <!-- Left Column - Image -->
      <div class="features-split-reverse-image features-split-reverse-animate">
        <div class="features-split-reverse-image-bg features-split-reverse-animate"></div>
      </div>

      <!-- Right Column - Content -->
      <div class="features-split-reverse-content features-split-reverse-animate">
        <h2 class="features-split-reverse-title features-split-reverse-animate">{title}</h2>
        <p class="features-split-reverse-description features-split-reverse-animate">
          {description}
        </p>
      </div>
    </div>
  </div>
</section>

<script>
  // Staggered animation for all elements
  document.addEventListener('DOMContentLoaded', function() {
    const animatedElements = document.querySelectorAll('.features-split-reverse-animate');
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry, index) => {
        if (entry.isIntersecting) {
          setTimeout(() => {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
          }, index * 150);
        }
      });
    }, {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    });

    animatedElements.forEach(element => {
      observer.observe(element);
    });
  });
</script>
